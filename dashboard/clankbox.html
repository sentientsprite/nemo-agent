<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üè¢ THE CLANKBOX | Agent HQ v2.0</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  
  * { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
    image-rendering: pixelated;
  }
  
  body { 
    font-family: 'Press Start 2P', monospace;
    background: #1a1c2c;
    color: #f4f4f4;
    min-height: 100vh;
    overflow-x: hidden;
  }
  
  /* CRT Scanline Effect */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
      0deg,
      rgba(0, 0, 0, 0.15),
      rgba(0, 0, 0, 0.15) 1px,
      transparent 1px,
      transparent 2px
    );
    pointer-events: none;
    z-index: 1000;
  }
  
  /* Header */
  .header {
    background: linear-gradient(180deg, #2d1b2e 0%, #1a1c2c 100%);
    border-bottom: 4px solid #5d275d;
    padding: 15px;
    text-align: center;
    position: relative;
  }
  
  .header h1 {
    font-size: 20px;
    color: #ffcd75;
    text-shadow: 3px 3px 0px #5d275d;
    margin-bottom: 8px;
  }
  
  .header-stats {
    display: flex;
    justify-content: center;
    gap: 20px;
    font-size: 8px;
  }
  
  .stat-box {
    background: #29366f;
    padding: 6px 10px;
    border: 2px solid #1a1c2c;
    box-shadow: inset -2px -2px 0 #1a1c2c, inset 2px 2px 0 #5965a3;
  }
  
  .stat-label { color: #94b0c2; font-size: 6px; }
  .stat-value { color: #38b764; margin-top: 2px; }

  /* Main Game Area - Office Space */
  .game-world {
    position: relative;
    width: 100%;
    height: 600px;
    background: 
      /* Floor tiles */
      repeating-linear-gradient(90deg, #2a2a3a 0px, #2a2a3a 40px, #323242 40px, #323242 80px),
      repeating-linear-gradient(0deg, #2a2a3a 0px, #2a2a3a 40px, #323242 40px, #323242 80px);
    border: 4px solid #5d275d;
    overflow: hidden;
    margin-bottom: 20px;
  }

  /* Office Furniture - Desks */
  .desk {
    position: absolute;
    width: 60px;
    height: 40px;
    background: #5d4e37;
    border: 2px solid #3d3225;
  }
  
  .desk::before {
    content: '';
    position: absolute;
    top: -15px;
    left: 5px;
    width: 50px;
    height: 15px;
    background: #6d5e47;
    border: 2px solid #3d3225;
  }

  /* Computer on desk */
  .computer {
    position: absolute;
    top: -25px;
    left: 20px;
    width: 20px;
    height: 15px;
    background: #1a1c2c;
    border: 2px solid #94b0c2;
  }
  
  .computer::after {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 12px;
    height: 8px;
    background: #38b764;
    animation: screenGlow 2s infinite;
  }

  @keyframes screenGlow {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }

  /* Plants */
  .plant {
    position: absolute;
    width: 20px;
    height: 30px;
    background: #2d5016;
    border-radius: 50% 50% 0 0;
  }
  
  .plant::before {
    content: '';
    position: absolute;
    bottom: -10px;
    left: -5px;
    width: 30px;
    height: 15px;
    background: #8b4513;
    border-radius: 2px;
  }

  /* 8-Bit Human Avatar */
  .avatar {
    position: absolute;
    width: 24px;
    height: 36px;
    transition: all 0.3s ease;
    z-index: 10;
    cursor: pointer;
  }

  .avatar:hover {
    transform: scale(1.2);
    z-index: 20;
  }

  /* Avatar Body Parts */
  .avatar-head {
    position: absolute;
    top: 0;
    left: 4px;
    width: 16px;
    height: 16px;
    background: #fdbcb4;
    border: 2px solid #1a1c2c;
  }

  .avatar-hair {
    position: absolute;
    top: -4px;
    left: 2px;
    width: 20px;
    height: 10px;
    background: #4a3728;
    border: 2px solid #1a1c2c;
  }

  .avatar-body {
    position: absolute;
    top: 16px;
    left: 2px;
    width: 20px;
    height: 14px;
    border: 2px solid #1a1c2c;
  }

  .avatar-legs {
    position: absolute;
    top: 30px;
    left: 4px;
    width: 16px;
    height: 6px;
    background: #3d3225;
    border: 2px solid #1a1c2c;
  }

  /* Walking Animation */
  .avatar.walking .avatar-legs {
    animation: walk 0.3s infinite alternate;
  }

  @keyframes walk {
    0% { transform: translateX(-2px); }
    100% { transform: translateX(2px); }
  }

  /* Direction facing */
  .avatar.left .avatar-head,
  .avatar.left .avatar-body,
  .avatar.left .avatar-hair {
    transform: scaleX(-1);
  }

  /* Different outfit colors */
  .avatar.commander .avatar-body { background: #ef7d57; }
  .avatar.researcher .avatar-body { background: #38b764; }
  .avatar.coder .avatar-body { background: #257179; }
  .avatar.trader .avatar-body { background: #ffcd75; }
  .avatar.analyst .avatar-body { background: #b13e53; }
  .avatar.security .avatar-body { background: #5d275d; }
  .avatar.writer .avatar-body { background: #94b0c2; }
  .avatar.monitor .avatar-body { background: #a7f070; }
  .avatar.planner .avatar-body { background: #3b5dc9; }
  .avatar.learner .avatar-body { background: #29366f; }
  .avatar.watercooler .avatar-body { background: #00d4ff; }

  /* Name tag above avatar */
  .avatar-name {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 6px;
    color: #fff;
    background: rgba(0,0,0,0.7);
    padding: 2px 4px;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.2s;
  }

  .avatar:hover .avatar-name {
    opacity: 1;
  }

  /* Thought bubble */
  .thought-bubble {
    position: absolute;
    top: -50px;
    left: 50%;
    transform: translateX(-50%);
    background: #fff;
    color: #1a1c2c;
    padding: 6px 10px;
    font-size: 7px;
    border: 2px solid #1a1c2c;
    border-radius: 4px;
    white-space: nowrap;
    opacity: 0;
    animation: fadeInOut 4s forwards;
    z-index: 30;
  }

  .thought-bubble::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 8px solid #1a1c2c;
  }

  @keyframes fadeInOut {
    0% { opacity: 0; transform: translateX(-50%) translateY(10px); }
    10% { opacity: 1; transform: translateX(-50%) translateY(0); }
    80% { opacity: 1; }
    100% { opacity: 0; }
  }

  /* Chat Section */
  .chat-container {
    background: #29366f;
    border: 4px solid #1a1c2c;
    box-shadow: 
      inset -4px -4px 0 #1a1c2c,
      inset 4px 4px 0 #5965a3;
    display: flex;
    flex-direction: column;
    height: 600px;
    position: sticky;
    top: 20px;
  }
  
  .chat-header {
    background: #5d275d;
    padding: 10px;
    font-size: 10px;
    color: #ffcd75;
    text-align: center;
    border-bottom: 3px solid #1a1c2c;
  }
  
  .chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
    font-size: 8px;
    line-height: 1.8;
  }
  
  .chat-message {
    margin-bottom: 10px;
    padding: 8px;
    background: #1a1c2c;
    border-left: 3px solid #5d275d;
  }
  
  .chat-message.mention {
    border-left-color: #ef7d57;
    background: #2d1b2e;
  }
  
  .chat-author {
    color: #ffcd75;
    margin-bottom: 4px;
  }
  
  .chat-text {
    color: #f4f4f4;
  }
  
  .chat-time {
    color: #94b0c2;
    font-size: 6px;
    margin-top: 4px;
  }

  /* Action Bar */
  .action-bar {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    padding: 0 20px;
  }
  
  .btn {
    background: #b13e53;
    border: none;
    padding: 10px 15px;
    font-family: 'Press Start 2P', monospace;
    font-size: 8px;
    color: #f4f4f4;
    cursor: pointer;
    box-shadow: inset -2px -2px 0 #8b1e33, inset 2px 2px 0 #d45e73;
  }
  
  .btn.green {
    background: #38b764;
    box-shadow: inset -2px -2px 0 #257179, inset 2px 2px 0 #58d784;
  }

  .btn:hover {
    transform: translateY(-2px);
  }

  /* Agent List Sidebar */
  .agent-list {
    background: #1a1c2c;
    border: 3px solid #5d275d;
    padding: 10px;
    margin-top: 15px;
  }

  .agent-list-title {
    font-size: 10px;
    color: #ffcd75;
    margin-bottom: 10px;
    text-align: center;
  }

  .agent-row {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px;
    font-size: 8px;
    border-bottom: 1px solid #29366f;
    cursor: pointer;
  }

  .agent-row:hover {
    background: #29366f;
  }

  .agent-status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .agent-status-dot.active { background: #38b764; }
  .agent-status-dot.idle { background: #ffcd75; }

  /* Responsive */
  @media (max-width: 1200px) {
    .game-world { height: 400px; }
    .chat-container { height: 400px; }
  }
</style>
</head>
<body>
<div class="header">
  <h1>üè¢ THE CLANKBOX</h1>
  <div class="header-stats">
    <div class="stat-box">
      <div class="stat-label">AGENTS</div>
      <div class="stat-value">11 ACTIVE</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">QUESTS</div>
      <div class="stat-value">3 ACTIVE</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">XP</div>
      <div class="stat-value">12,450</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">LEVEL</div>
      <div class="stat-value">LV.8</div>
    </div>
  </div>
</div>

<div style="padding: 20px; max-width: 1400px; margin: 0 auto;">
  <div class="action-bar">
    <button class="btn green" onclick="callTeamMeeting()">üì¢ TEAM MEETING</button>
    <button class="btn" onclick="scatterAgents()">üèÉ SCATTER</button>
    <button class="btn" onclick="returnToDesks()">üíª TO DESKS</button>
    <button class="btn" onclick="toggleWaterCooler()">üíß WATER COOLER</button>
  </div>

  <div style="display: grid; grid-template-columns: 1fr 350px; gap: 20px;">
    <!-- Game World -->
    <div>
      <div class="game-world" id="gameWorld">
        <!-- Desks -->
        <div class="desk" style="top: 50px; left: 80px;"><div class="computer"></div></div>
        <div class="desk" style="top: 50px; left: 200px;"><div class="computer"></div></div>
        <div class="desk" style="top: 50px; left: 320px;"><div class="computer"></div></div>
        <div class="desk" style="top: 150px; left: 80px;"><div class="computer"></div></div>
        <div class="desk" style="top: 150px; left: 200px;"><div class="computer"></div></div>
        <div class="desk" style="top: 150px; left: 320px;"><div class="computer"></div></div>
        <div class="desk" style="top: 250px; left: 80px;"><div class="computer"></div></div>
        <div class="desk" style="top: 250px; left: 200px;"><div class="computer"></div></div>
        <div class="desk" style="top: 250px; left: 320px;"><div class="computer"></div></div>
        <div class="desk" style="top: 350px; left: 80px;"><div class="computer"></div></div>
        <div class="desk" style="top: 350px; left: 320px;"><div class="computer"></div></div>
        
        <!-- Plants -->
        <div class="plant" style="top: 30px; left: 30px;"></div>
        <div class="plant" style="top: 30px; left: 420px;"></div>
        <div class="plant" style="top: 450px; left: 30px;"></div>
        <div class="plant" style="top: 450px; left: 420px;"></div>

        <!-- Water Cooler Area -->
        <div style="position: absolute; top: 400px; left: 200px; width: 80px; height: 60px; background: #4a90e2; border: 3px solid #1a1c2c; border-radius: 4px;">
          <div style="position: absolute; top: 10px; left: 10px; width: 60px; height: 40px; background: #87ceeb; border: 2px solid #1a1c2c;"></div>
          <div style="position: absolute; top: -20px; left: 25px; width: 30px; height: 25px; background: #fff; border: 2px solid #1a1c2c;"></div>
        </div>

        <!-- Avatars will be spawned here -->
      </div>

      <!-- Agent List -->
      <div class="agent-list">
        <div class="agent-list-title">üë• CLICK AGENT TO FOCUS</div>
        <div id="agentList"></div>
      </div>
    </div>

    <!-- Chat -->
    <div class="chat-container">
      <div class="chat-header">üí¨ AGENT CHAT</div>
      <div class="chat-messages" id="chatMessages"></div>
      <div style="padding: 10px; background: #1a1c2c; border-top: 3px solid #5d275d;">
        <input type="text" id="chatInput" placeholder="Type message..." 
          style="width: 100%; background: #29366f; border: 2px solid #5d275d; color: #f4f4f4; padding: 8px; font-family: 'Press Start 2P'; font-size: 8px;"
          onkeypress="if(event.key==='Enter')sendMessage()">
        <div style="font-size: 6px; color: #94b0c2; margin-top: 5px;">Try: status | @name | meeting</div>
      </div>
    </div>
  </div>
</div>

<script>
// Agent Data
const agents = {
  commander: { name: "Commander", role: "Orchestrator", color: "#ef7d57", status: "active", desk: {x: 90, y: 60} },
  researcher: { name: "Researcher", role: "Intel", color: "#38b764", status: "active", desk: {x: 210, y: 60} },
  coder: { name: "Coder", role: "Architect", color: "#257179", status: "active", desk: {x: 330, y: 60} },
  trader: { name: "Trader", role: "Execution", color: "#ffcd75", status: "active", desk: {x: 90, y: 160} },
  analyst: { name: "Analyst", role: "Data", color: "#b13e53", status: "idle", desk: {x: 210, y: 160} },
  security: { name: "Security", role: "Guardian", color: "#5d275d", status: "active", desk: {x: 330, y: 160} },
  writer: { name: "Writer", role: "Communicator", color: "#94b0c2", status: "idle", desk: {x: 90, y: 260} },
  monitor: { name: "Monitor", role: "Watcher", color: "#a7f070", status: "active", desk: {x: 210, y: 260} },
  planner: { name: "Planner", role: "Strategist", color: "#3b5dc9", status: "idle", desk: {x: 330, y: 260} },
  learner: { name: "Learner", role: "Self-Improver", color: "#29366f", status: "idle", desk: {x: 90, y: 360} },
  watercooler: { name: "Water Cooler", role: "Break Room", color: "#00d4ff", status: "active", desk: {x: 240, y: 420} }
};

// Spawn avatars
function spawnAvatars() {
  const world = document.getElementById('gameWorld');
  
  Object.entries(agents).forEach(([id, agent]) => {
    const avatar = document.createElement('div');
    avatar.className = `avatar ${id}`;
    avatar.id = `avatar-${id}`;
    avatar.style.left = agent.desk.x + 'px';
    avatar.style.top = agent.desk.y + 'px';
    avatar.onclick = () => focusAgent(id);
    
    avatar.innerHTML = `
      <div class="avatar-name">${agent.name}</div>
      <div class="avatar-hair"></div>
      <div class="avatar-head"></div>
      <div class="avatar-body"></div>
      <div class="avatar-legs"></div>
    `;
    
    world.appendChild(avatar);
    
    // Start random movement for active agents
    if (agent.status === 'active') {
      setInterval(() => randomMove(id), 5000 + Math.random() * 5000);
    }
  });
}

// Random movement
function randomMove(agentId) {
  const avatar = document.getElementById(`avatar-${agentId}`);
  if (!avatar) return;
  
  const agent = agents[agentId];
  const world = document.getElementById('gameWorld');
  const maxX = world.offsetWidth - 50;
  const maxY = world.offsetHeight - 50;
  
  // 30% chance to move, 70% stay at desk
  if (Math.random() > 0.3) {
    // Return to desk
    moveAvatar(agentId, agent.desk.x, agent.desk.y);
    return;
  }
  
  // Random destination
  const newX = Math.max(20, Math.random() * maxX);
  const newY = Math.max(20, Math.random() * maxY);
  
  moveAvatar(agentId, newX, newY);
}

// Move avatar with animation
function moveAvatar(agentId, targetX, targetY) {
  const avatar = document.getElementById(`avatar-${agentId}`);
  if (!avatar) return;
  
  const currentX = parseInt(avatar.style.left);
  const direction = targetX < currentX ? 'left' : 'right';
  
  avatar.classList.add('walking', direction);
  avatar.style.left = targetX + 'px';
  avatar.style.top = targetY + 'px';
  
  setTimeout(() => {
    avatar.classList.remove('walking');
  }, 1000);
}

// Show thought bubble
function showThought(agentId, text) {
  const avatar = document.getElementById(`avatar-${agentId}`);
  if (!avatar) return;
  
  const bubble = document.createElement('div');
  bubble.className = 'thought-bubble';
  bubble.textContent = text;
  avatar.appendChild(bubble);
  
  setTimeout(() => bubble.remove(), 4000);
}

// Chat functions
function addMessage(author, text, isSystem = false) {
  const chat = document.getElementById('chatMessages');
  const div = document.createElement('div');
  div.className = 'chat-message';
  
  const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
  
  if (isSystem) {
    div.innerHTML = `<div class="chat-author" style="color: #ffcd75">üêü SYSTEM</div><div class="chat-text">${text}</div><div class="chat-time">${time}</div>`;
  } else {
    const agent = agents[author];
    div.innerHTML = `<div class="chat-author" style="color: ${agent.color}">${agent.name}</div><div class="chat-text">${text}</div><div class="chat-time">${time}</div>`;
  }
  
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById('chatInput');
  const text = input.value.trim();
  if (!text) return;
  
  input.value = '';
  addMessage(null, `üë§ Captain: ${text}`, true);
  
  // Agent responses
  setTimeout(() => {
    if (text.toLowerCase().includes('status')) {
      addMessage('commander', "All agents accounted for. 5 active, 6 idle. Systems nominal.");
    } else if (text.toLowerCase().includes('meeting')) {
      callTeamMeeting();
    } else if (text.includes('@')) {
      const name = text.match(/@(\w+)/)?.[1];
      const agentId = Object.keys(agents).find(id => agents[id].name.toLowerCase() === name?.toLowerCase());
      if (agentId) {
        addMessage(agentId, "Yes, Captain? I'm here.");
        showThought(agentId, "üìã Ready for orders!");
      }
    }
  }, 500);
}

// Actions
function callTeamMeeting() {
  addMessage(null, "üì¢ TEAM MEETING CALLED!", true);
  
  // Move all agents to center
  Object.keys(agents).forEach((id, i) => {
    setTimeout(() => {
      moveAvatar(id, 200 + (i * 15), 300 + (i * 10));
      showThought(id, "ü´° Reporting!");
    }, i * 200);
  });
  
  setTimeout(() => {
    addMessage('commander', "Team assembled. Awaiting your orders, Captain.");
  }, 2000);
}

function scatterAgents() {
  addMessage(null, "üèÉ SCATTER! Free roam activated.", true);
  Object.keys(agents).forEach(id => {
    const maxX = 450;
    const maxY = 500;
    moveAvatar(id, Math.random() * maxX, Math.random() * maxY);
  });
}

function returnToDesks() {
  addMessage(null, "üíª Everyone back to work!", true);
  Object.entries(agents).forEach(([id, agent]) => {
    moveAvatar(id, agent.desk.x, agent.desk.y);
  });
}

function toggleWaterCooler() {
  const wc = document.getElementById('avatar-watercooler');
  if (wc) {
    // Gather agents at water cooler
    addMessage('watercooler', "Coffee's hot! Come chat! ‚òï", false);
    Object.keys(agents).slice(0, 5).forEach((id, i) => {
      setTimeout(() => {
        moveAvatar(id, 220 + Math.random() * 40, 380 + Math.random() * 30);
        showThought(id, "‚òï Coffee time!");
      }, i * 300);
    });
  }
}

function focusAgent(agentId) {
  const agent = agents[agentId];
  showThought(agentId, `Hi! I'm ${agent.name}, ${agent.role}`);
}

// Build agent list
function buildAgentList() {
  const list = document.getElementById('agentList');
  list.innerHTML = Object.entries(agents).map(([id, agent]) => `
    <div class="agent-row" onclick="focusAgent('${id}')">
      <div class="agent-status-dot ${agent.status}"></div>
      <span style="color: ${agent.color}">${agent.name}</span>
      <span style="color: #94b0c2; margin-left: auto;">${agent.role}</span>
    </div>
  `).join('');
}

// Random agent thoughts
function randomThoughts() {
  const activeAgents = Object.keys(agents).filter(id => agents[id].status === 'active');
  const randomAgent = activeAgents[Math.floor(Math.random() * activeAgents.length)];
  
  const thoughts = [
    "üí≠ Working hard...",
    "üí≠ Almost done...",
    "üí≠ Need coffee...",
    "üí≠ Good progress!",
    "üí≠ Checking data...",
    "üí≠ Optimizing..."
  ];
  
  showThought(randomAgent, thoughts[Math.floor(Math.random() * thoughts.length)]);
}

// Initialize
window.onload = () => {
  spawnAvatars();
  buildAgentList();
  addMessage(null, "üè¢ Welcome to THE CLANKBOX!", true);
  addMessage(null, "Click agents to focus. Use buttons to control the office.", true);
  
  // Random thoughts every 10 seconds
  setInterval(randomThoughts, 10000);
};
</script>
</body>
</html>
